<!DOCTYPE html>
<html>


  <head>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script
    async
    src="https://www.googletagmanager.com/gtag/js?id=UA-79615115-1">
</script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-79615115-1');
</script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Deploying to Maven Central</title>

    <link
       rel="stylesheet"
       href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
       integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7"
       crossorigin="anonymous" />

    <link
       rel="stylesheet"
       href="../yawg-site.css?v=20f39f14-0926-411d-b6a2-1c13db9cdeb7" />

    <link
       rel="stylesheet"
       href="../fontawesome-free-5.14.0-web/css/all.min.css" />

    <script
       type="text/javascript"
       async
       src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>

  </head>

  <body>

    <div class="yawg-body">


    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="../index.html"><img src="../YawgLogo-standard.png" style="height:1.5em;"/></a>
          <a class="navbar-brand" href="../index.html">Yawg</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
    <li><a href="../index.html">Home</a></li>
    <li><a href="../Download/index.html">Download</a></li>
    <li><a href="../Documentation/index.html">Documentation</a></li>
    <li class="active"><a href="../Developers/index.html">Developers</a></li>
            <li><a href="https://github.com/jorgefranconunes/yawg">GitHub repository</a></li>

          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>



      <div class="container yawg-content">


  <!#-- The breadcrumb bar is only visible if there is more than
        one bread crumb on this page.-->

    <ol class="breadcrumb">
          <li><a href=".././index.html">Home</a></li>
          <li><a href="../Developers/index.html">Developers</a></li>
    </ol>

        <h1>Deploying to Maven Central</h1>
        <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a></li>
<li><a href="#sec-PrepareGpgKey">2. Prepare GPG key</a>
<ul class="sectlevel2">
<li><a href="#_install_gnupg">2.1. Install GnuPG</a></li>
<li><a href="#_generate_a_key_pair">2.2. Generate a key pair</a></li>
<li><a href="#_distribute_gpg_public_key">2.3. Distribute GPG public key</a></li>
</ul>
</li>
<li><a href="#sec-CreateJiraAccount">3. Create Sonatype JIRA account</a></li>
<li><a href="#sec-RegisterYawgOnOssrh">4. Register Yawg project on OSSRH</a></li>
<li><a href="#sec-AddOssrhToMavenConfig">5. Add OSSRH repository to Maven config</a></li>
<li><a href="#sec-AddCredentialsToMavenSettings">6. Add credentials to Maven settings</a></li>
<li><a href="#sec-DeployNewRelease">7. Deploy new release to Maven Central</a>
<ul class="sectlevel2">
<li><a href="#_deploy_to_the_staging_repository">7.1. Deploy to the staging repository</a></li>
<li><a href="#_promote_from_staging_repo_to_maven_central">7.2. Promote from staging repo to Maven Central</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document contains some technical notes on deploying a Yawg
release to the Maven Central repository.  For the exact steps to
follow when createing a new Yawg release please see
<a href="CreatingRelease.html">Creating a release of the Yawg software</a>.</p>
</div>
<div class="paragraph">
<p>The information contained in this document was gleaned from the following sources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://maven.apache.org/guides/mini/guide-central-repository-upload.html">Guide
to uploading artifacts to the Central Repository</a></p>
</li>
<li>
<p><a href="http://central.sonatype.org/pages/ossrh-guide.html">OSSRH Guide</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Actions that have to be performed only once:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#sec-PrepareGpgKey">Prepare GPG key</a></p>
</li>
<li>
<p><a href="#sec-CreateJiraAccount">Create Sonatype JIRA account</a></p>
</li>
<li>
<p><a href="#sec-RegisterYawgOnOssrh">Register Yawg project on OSSRH</a></p>
</li>
<li>
<p><a href="#sec-AddOssrhToMavenConfig">Add OSSRH repository to Maven config</a></p>
</li>
<li>
<p><a href="#sec-AddCredentialsToMavenSettings">Add credentials to Maven settings</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Actions that have to be performed for each time a new Yawg release is
created:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#sec-DeployNewRelease">Deploy new release to Maven Central</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-PrepareGpgKey">2. Prepare GPG key</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A GPG key is required for signing the build artifacts that are
uploaded to Maven central. That same GPG key will be used by Sonatype
Nexus for validating the artifacts as part of the steps for deploying
to Maven Central. That GPG key thus needs to be available from one of
the more common GPG key servers.</p>
</div>
<div class="paragraph">
<p>This section describes how to create a GPG key, and distribute it to
one GPG key server.</p>
</div>
<div class="sect2">
<h3 id="_install_gnupg">2.1. Install GnuPG</h3>
<div class="paragraph">
<p>The GPG tools are available in a standard package in most Linux
distributions. You will need to manually install the appropriate
package for your platform.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CentOS: <code>gnupg2</code></p>
</li>
<li>
<p>Ubuntu: <code>gnupg</code></p>
</li>
<li>
<p>Cygwin: gnupg</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_generate_a_key_pair">2.2. Generate a key pair</h3>
<div class="paragraph">
<p>To generate the actual GPG key run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">gpg --gen-key</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above command will request some information. An example follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Please select what kind of key you want: -- (1) RSA and RSA (default)
What keysize do you want? (2048) -- 2048
Key is valid for? (0) -- 0 = key does not expire
Real name: -- My Name
Email address: -- myemail@somewhere.com
Comment: --</pre>
</div>
</div>
<div class="paragraph">
<p>Some useful commands follow.</p>
</div>
<div class="paragraph">
<p>List local keys:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gpg --list-keys</pre>
</div>
</div>
<div class="paragraph">
<p>Search key in key server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gpg --keyserver hkp://keys.gnupg.net --search-key 'myemail@somewhere.com'</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_distribute_gpg_public_key">2.3. Distribute GPG public key</h3>
<div class="paragraph">
<p>The new GPG key must be distributed to one of the GPG key servers that
Sonatype uses when validating GPG keys.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gpg --keyserver hkp://keys.gnupg.net --send-key 701FCC65</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-CreateJiraAccount">3. Create Sonatype JIRA account</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A Sonatype JIRA account is required for opening a ticket to register
the Yawg project on OSSRH.</p>
</div>
<div class="paragraph">
<p>To create a Sonatype JIRA account go to <a href="https://issues.sonatype.org/" class="bare">https://issues.sonatype.org/</a>
and select the link for signing up for a new account.</p>
</div>
<div class="paragraph">
<p>As an example used in commands, and files below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Username:</strong> myusername</p>
</li>
<li>
<p><strong>Email:</strong> <a href="mailto:myemail@somewhere.com">myemail@somewhere.com</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The same username and password will also be used to login into
Sonatype Nexus later on.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-RegisterYawgOnOssrh">4. Register Yawg project on OSSRH</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To register the Yawg project on OSSRH a Jira ticket must be opened for
submitting the request.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to <a href="https://issues.sonatype.org/" class="bare">https://issues.sonatype.org/</a></p>
</li>
<li>
<p>Login with the credentials defined in the previous section.</p>
</li>
<li>
<p>Create a new ticket with "Issue Type" as "New Project".</p>
</li>
<li>
<p>Wait for an email from Sonatype with confirmation the project has
been created.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the case of the Ywag project the ticket was
<a href="https://issues.sonatype.org/browse/OSSRH-31607" class="bare">https://issues.sonatype.org/browse/OSSRH-31607</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-AddOssrhToMavenConfig">5. Add OSSRH repository to Maven config</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add to the <code>distributionManagement</code> element an entry for the Open
Source Software Repository Hosting (OSSRH) repository.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"> <span style="color:#070;font-weight:bold">&lt;distributionManagement&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;repository&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;id&gt;</span>yawg.ossrh<span style="color:#070;font-weight:bold">&lt;/id&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;url&gt;</span>https://oss.sonatype.org/service/local/staging/deploy/maven2/<span style="color:#070;font-weight:bold">&lt;/url&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/repository&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/distributionManagement&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-AddCredentialsToMavenSettings">6. Add credentials to Maven settings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add the OSSRH Jira credentials, and the GnuPG key credentials to your
<code>~/.m2/settings.xml</code> Maven configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;settings&gt;</span>

  <span style="color:#070;font-weight:bold">&lt;servers&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;server&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;id&gt;</span>yawg.ossrh<span style="color:#070;font-weight:bold">&lt;/id&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;username&gt;</span>myusername<span style="color:#070;font-weight:bold">&lt;/username&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;password&gt;</span>XXXXXX<span style="color:#070;font-weight:bold">&lt;/password&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/server&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/servers&gt;</span>

  <span style="color:#070;font-weight:bold">&lt;profiles&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;profile&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;id&gt;</span>yawg-maven-artifacts<span style="color:#070;font-weight:bold">&lt;/id&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;properties&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;gpg.keyname&gt;</span>701FCC65<span style="color:#070;font-weight:bold">&lt;/gpg.keyname&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;gpg.passphrase&gt;</span>XXXXXX<span style="color:#070;font-weight:bold">&lt;/gpg.passphrase&gt;</span>
      <span style="color:#070;font-weight:bold">&lt;/properties&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/profile&gt;</span>
  <span style="color:#070;font-weight:bold">&lt;/profiles&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/settings&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Make sure the file is readable only by the owner:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>chmod 600 ~/.m2/settings.xml</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-DeployNewRelease">7. Deploy new release to Maven Central</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_deploy_to_the_staging_repository">7.1. Deploy to the staging repository</h3>
<div class="listingblock">
<div class="content">
<pre>./devtools/bin/build-bundle --release</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_promote_from_staging_repo_to_maven_central">7.2. Promote from staging repo to Maven Central</h3>
<div class="ulist">
<ul>
<li>
<p>Login into <a href="https://oss.sonatype.org/" class="bare">https://oss.sonatype.org/</a></p>
</li>
<li>
<p>Look for the latest staging repo named <code>comvarmateo</code></p>
</li>
<li>
<p>Click the <code>Close</code> action for the repository. This will prepare the
staging repository for being copied to Maven Central.</p>
</li>
<li>
<p>Click the <code>Release</code> action for the repository. This will copy the
staging repository to Maven Central. This process can take some
minutes to complete. You can confirm the process has completed by
checking on Maven Central at
<a href="https://repo1.maven.org/maven2/com/varmateo/yawg/yawg-api/" class="bare">https://repo1.maven.org/maven2/com/varmateo/yawg/yawg-api/</a> that the
new version is there.</p>
</li>
</ul>
</div>
</div>
</div>
</div>


<footer class="yawg-footer">
  <p>&copy;2020 Jorge Nunes</p>
  <p>
    Mixed with
    <a href="http://getbootstrap.com/" target="_blank">Bootstrap 3.3.6</a>
    |
    Baked with
    <a href="http://yawg.varmateo.com/">Yawg 1.0.0-RC3</a>
    |
    <a href="../Acknowledgements.html">Acknowledgements</a>
    |
    <a href="../PrivacyPolicy.html">Privacy</a>
    |
    Last update 2020-08-23 11:26 UTC
  </p>
</footer>

      </div>

    </div>

  </body>

</html>
